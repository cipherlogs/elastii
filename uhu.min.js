const compose=e=>t=>n=>e(t(n)),tap=e=>t=>(e(t),t),props=e=>t=>e.reduce(((e,t)=>e[t]),t),pipe=e=>t=>e.reduce(((e,t)=>t(e)),t),when=e=>t=>n=>e(n)?t(n):n,on=e=>t=>n=>n.addEventListener(e,t),from=e=>t=>e.querySelectorAll(t)[0],K=e=>t=>e,T=e=>t=>t(e),$=T,log=console.log,debug=compose(tap(log)),prop=e=>props([e]),select=from(document),gt=e=>t=>t>e,eq=e=>t=>e===t,nth=e=>t=>t[e],head=e=>e[0],tail=e=>e[e.length-1],is_zero=eq(0),is_undef=eq(void 0),length=e=>e.length,sub=e=>t=>t-e,add=e=>t=>t+e,inc=add(1),dec=sub(1),map=e=>t=>t.map(e),sum=e=>e.reduce(((e,t)=>e+t),0),is_empty=e=>eq(0)(length(e)),crop=e=>e.slice(1,-1),length_gt=e=>compose(gt(e))(length),floor=e=>Math.floor(e),cut_at=e=>t=>[...t.slice(0,e),...t.slice(e+1,length(t))],$html=select("html"),get_gallery=()=>select(".gallery"),get_img_count=pipe([get_gallery,props(["children","length"])]),get_client_width=()=>props(["clientWidth"])($html),rand=e=>t=>floor(Math.random()*(t-e+1)+e),up_to=rand(1),range=e=>t=>e>=t?[t]:[e,...range(inc(e))(t)],dec_percent=e=>t=>floor(t-t*(e/100)),duplicate=e=>when(gt(0))((t=>map(K(t))(range(1)(e)))),split_by=e=>t=>{if(e>t)return split_by(t)(e);const n=t%e,r=floor(t/e),l=gt(t)(inc(r)*e)?duplicate(dec(e))(r):duplicate(dec(e))(inc(r));return eq(0)(n)?duplicate(e)(r):[t].reduce(((e,t)=>{return e.concat([t-(n=e,n.reduce(((e,t)=>e+t),0))]);var n}),l)},inc_dec=e=>([t,n])=>{const r=is_empty(e)?[[t,n]]:e,l=gt(1)(n)?[inc(t),dec(n)]:void 0;return void 0===l?r:inc_dec([...r,l])(l)},shuffle_ends=e=>{const t=pipe([e=>inc_dec([])([head(e),tail(e)]),map((([t,n])=>{return[t,...(r=e,r.slice(1,-1)),n];var r}))]);return when(compose(gt(1))(length))(t)(e)},median=e=>floor(length(e)/2),backward=e=>t=>eq(e)(median(t))?[]:(gt(0)(e)?shuffle_ends(t.slice(e,-1*e)).map((n=>[...t.slice(0,e),...n,...t.slice(-1*e)])):shuffle_ends(t)).concat(backward(inc(e))(t)),split_by_all=e=>t=>gt(1)(e)?backward(0)(split_by(e)(t)):t,random_nth=e=>e[rand(0)(length(e)-1)],shuffle_arr=e=>{const t=rand(0)(length(e)-1);return is_empty(e)?[]:[(r=t,e=>e[r])(e),...shuffle_arr((n=t,e=>[...e.slice(0,n),...e.slice(n+1,length(e))])(e))];var n,r},make_row=e=>t=>n=>{const r=up_to(e),l=gt(1)(n)?shuffle_arr((i=split_by_all(n)(t))[rand(0)(length(i)-1)]):[t];var i;return map((e=>[e,r]))(l)},item_per_row=e=>t=>{const n=up_to(t<e?t:e);return is_zero(t)?[]:[n,...item_per_row(e)(t-n)]},grid=e=>t=>n=>{const r=item_per_row(n)(e);return map(make_row(t)(n))(r)},inject_style=e=>select("style").innerHTML+=e,counter=e=>{let t=dec(e);return()=>(t=inc(t),t)},template_span=e=>t=>n=>r=>`\n  .gallery__item:nth-child(${e}) {\n    grid-area: span ${n} / span ${t};\n    height: ${r*n}px\n  }\n`,get_grid_factor=e=>{const t=t=>gt(t)(e);return t(4096)?800:t(3840)?600:t(2048)?500:t(1920)?400:t(1080)?300:t(300)?200:150},update_grid=e=>{const{element_count:t,grid_size:n,factor:r,height:l}=e,i=counter(1),a=(c=t,e=>t=>{const n=item_per_row(t)(c);return map(make_row(e)(t))(n)})(l>0?l:n)(n);var c;const o=a.flat().reduce(((e,[t,n])=>e+template_span(i())(t)(n)(r)),"");inject_style(o),select(".gallery").style["grid-template-columns"]=`repeat(auto-fit, ${r}px)`,select(".gallery").style["grid-template-rows"]=`${r}px`},set_basic_styling=()=>inject_style("\n      .gallery {\n        display: grid;\n      }\n      .gallery__item {\n        overflow: hidden;\n      }\n      .gallery__item img {\n        max-width: 100%;\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n      }\n  "),update_grid_layout=(e,t)=>{const n=e>0?()=>100*e:()=>get_grid_factor(get_client_width()),r=()=>{inject_style("\n      .gallery {\n        display: grid;\n      }\n      .gallery__item {\n        overflow: hidden;\n      }\n      .gallery__item img {\n        max-width: 100%;\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n      }\n  "),update_grid({element_count:get_img_count(),grid_size:floor(get_client_width()/n()),factor:n(),height:t})};var l;r(),$(window)((l="resize",e=>t=>t.addEventListener(l,e))(r))};window.uhu =update_grid_layout;
